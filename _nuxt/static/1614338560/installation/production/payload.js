__NUXT_JSONP__("/installation/production", (function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,$,aa,ab,ac,ad,ae,af,ag,ah,ai,aj,ak,al,am,an,ao,ap,aq,ar,as,at,au,av,aw,ax,ay,az,aA,aB,aC,aD,aE,aF,aG,aH,aI,aJ,aK,aL,aM,aN,aO,aP,aQ,aR,aS,aT,aU,aV,aW,aX,aY,aZ,a_,a$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw,cx,cy,cz){return {data:[{document:{slug:"production",description:"Setup procedures for downloading and installing the application in a production environment on Azure.",title:"Production",category:"Installation",toc:[{id:aQ,depth:av,text:aR},{id:aS,depth:av,text:aT},{id:aU,depth:K,text:aV},{id:aW,depth:K,text:aX},{id:aY,depth:K,text:aZ},{id:a_,depth:av,text:a$},{id:ba,depth:K,text:bb},{id:bc,depth:K,text:bd},{id:be,depth:K,text:bf},{id:bg,depth:K,text:bh},{id:bi,depth:K,text:bj},{id:bk,depth:K,text:bl},{id:bm,depth:K,text:bn},{id:bo,depth:K,text:bp}],body:{type:"root",children:[{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"This page describes the resources and general setup processes for setting up the app in a production environment."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:R,props:{type:ac},children:[{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"This is not meant to be followed along by high school users but may prove educational to study. The technologies used require paid Azure resources."}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:aw,props:{id:aQ},children:[{type:b,tag:A,props:{href:"#requirements"},children:[{type:a,value:aR}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The following items will be required before setting up the application."}]},{type:a,value:c},{type:b,tag:S,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Azure Portal with configured subscription. The subscription is merely the payment grouping that has the credits available for use."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Domain Management. The application is designed to operate with the frontend on a primary domain and the api on an entirely separate domain, e.g. "},{type:b,tag:f,props:{},children:[{type:a,value:"app.orlandomathcircle.org"}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:bq}]},{type:a,value:", and need to be configured using A records to the virtual machine. SendGrid emailing will use a few records to ensure email authentication."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"PayPal API credentials. The OMC personnel who owns the Orlando Math Circle PayPal account needs to follow the steps to "},{type:b,tag:A,props:{href:"https:\u002F\u002Fdeveloper.paypal.com\u002Fdocs\u002Fapi\u002Foverview\u002F#get-credentials",rel:[X,Y,Z],target:_},children:[{type:a,value:"Obtain PayPal Credentials"}]},{type:a,value:" through registering the application on the developer dashboard. This yields a "},{type:b,tag:f,props:{},children:[{type:a,value:"Client ID"}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:br}]},{type:a,value:". Both identifiers are necessary to make PayPal payments. For safety during testing, developers can use their own PayPal developer credentials in a Sandbox mode to not risk accidentially using real money."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Twitter API Credentials. Someone within the OMC organization needs to apply to utilize the Twitter API. They utilize an "},{type:b,tag:A,props:{href:"https:\u002F\u002Fdeveloper.twitter.com\u002Fen\u002Fapply-for-access",rel:[X,Y,Z],target:_},children:[{type:a,value:"approval process"}]},{type:a,value:" and provide a "},{type:b,tag:f,props:{},children:[{type:a,value:br}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:"Client Secret"}]},{type:a,value:" similar to PayPal."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"SendGrid API Credentials. This tutorial will go through setting up SendGrid as it is part of Azure."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:aw,props:{id:aS},children:[{type:b,tag:A,props:{href:"#azure"},children:[{type:a,value:aT}]}]},{type:a,value:c},{type:b,tag:M,props:{id:aU},children:[{type:b,tag:A,props:{href:"#virtual-machine-procurement"},children:[{type:a,value:aV}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The virtual machine that should host the application is a called a "},{type:b,tag:f,props:{},children:[{type:a,value:"Standard_B2s"}]},{type:a,value:", which consists of 2 vCPU cores and 4GB of memory. To manage virtual machines you can visit the "},{type:b,tag:f,props:{},children:[{type:a,value:"Virtual machines"}]},{type:a,value:" resource in the Azure portal.\n"},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_vms.png",alt:"Azure Virtual Machines Sidebar"},children:[]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Find the add button at the top of the virtual machines directory and select the first option in the dropdown."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_add.png",alt:"Azure Add Virtual Machine"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The page should show various configurations for allocating a new virtual machine. The first option of which are the subscription and resource group. Subscriptions are services that are billed together and having a singular default subscription is sufficient. The resource group is like a \"folder to organize and manage your resources\", but creating a new resource group of any name will suffice. This guide does not cover resource group permissions."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_setup_1.png",alt:"Azure Groups"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The next options are the "},{type:b,tag:f,props:{},children:[{type:a,value:"instance details"}]},{type:a,value:" which consist of the desired amount of power, its location, and the operating system."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_setup_2.png",alt:ax},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:ak,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"The virtual machine name is an identifier, I have chosen "},{type:b,tag:f,props:{},children:[{type:a,value:"omc-app"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"The "},{type:b,tag:f,props:{},children:[{type:a,value:"region"}]},{type:a,value:" affects which datacenter to allocate the machine on, the closer to the users the better the latency. For Florida, "},{type:b,tag:f,props:{},children:[{type:a,value:bs}]},{type:a,value:" is ideal."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Ignore the "},{type:b,tag:f,props:{},children:[{type:a,value:"Availability options"}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:"Availability zone"}]},{type:a,value:" settings."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:bt},{type:b,tag:f,props:{},children:[{type:a,value:"image"}]},{type:a,value:" select "},{type:b,tag:f,props:{},children:[{type:a,value:"see all images"}]},{type:a,value:" and search for Ubuntu to find "},{type:b,tag:f,props:{},children:[{type:a,value:"Ubuntu Server 20.04 LTS"}]},{type:a,value:". If this guide is being utilized in the future, the latest "},{type:b,tag:ay,props:{},children:[{type:a,value:"LTS"}]},{type:a,value:" version of Ubuntu is desired."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Do not tick the "},{type:b,tag:f,props:{},children:[{type:a,value:"Azure Spot instance"}]},{type:a,value:" setting."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:bu},{type:b,tag:f,props:{},children:[{type:a,value:"Size"}]},{type:a,value:" the option desired is "},{type:b,tag:f,props:{},children:[{type:a,value:"Standard_B2s - 2 vcpus, 4 GiB memory ($30.37\u002Fmonth)"}]},{type:a,value:". It can be found by selecting "},{type:b,tag:f,props:{},children:[{type:a,value:"See all sizes"}]},{type:a,value:" and typing "},{type:b,tag:f,props:{},children:[{type:a,value:"B2s"}]},{type:a,value:" into the search bar."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Next, some sort of credentials need to be given to allow for accessing the default administrator account. As a personal preference I have used an RSA public key so the virtual machine simply recognizes my computer without having to enter a password all the time. This can be changed later and will not affect secondary users added to the VM."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_setup_3.png",alt:"Azure Account Details"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The last set of configurations on this page are the "},{type:b,tag:f,props:{},children:[{type:a,value:"Inbound port rules"}]},{type:a,value:" which describes which ports are open to the internet by default. "},{type:b,tag:f,props:{},children:[{type:a,value:"SSH (22)"}]},{type:a,value:" is selected by default for remote access, but be sure to also enable "},{type:b,tag:f,props:{},children:[{type:a,value:"HTTPS (443)"}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:"HTTP (80)"}]},{type:a,value:" as those are the ports responsible for website traffic. Note that this is not exhaustive and does not include the PostgreSQL port (if remote database management is desired)."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_setup_4.png",alt:"Azure Port Details"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The rest of the pages consist of more advanced features that aren't required to be changed or can be changed at a later date when necessary. Of note, the "},{type:b,tag:f,props:{},children:[{type:a,value:"Standard B2s"}]},{type:a,value:" instance comes with 8 GiB of temporary storage by default. While not an immediate concern, eventually the uploads will consume that free space and require the instance to be affixed with a managed storage drive."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:al},{type:b,tag:f,props:{},children:[{type:a,value:az}]},{type:a,value:" and it may ask for additional contact information such as the preferred email address and phone number for support issues. Once the information is entered, click on "},{type:b,tag:f,props:{},children:[{type:a,value:"Create"}]},{type:a,value:" where the review button was at the bottom of the page and allow for the instance to be generated. It should take only a couple of minutes for deployment to complete."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_setup_5.png",alt:ax},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once the instance is deployed it can be found by visiting the \"Virtual machines\" section of the Azure portal. Copy the "},{type:b,tag:f,props:{},children:[{type:a,value:"Public IP address"}]},{type:a,value:" and using the login information input in the credentials section of the instance configuration, connect to the instance using your preferred terminal."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:R,props:{type:aA},children:[{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Identifying information is not hidden from the following screenshots, though this virtual machine instance was destroyed before this tutorial went live, do not share screenshots showing connection information."}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_terminal_1.png",alt:ax},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:M,props:{id:aW},children:[{type:b,tag:A,props:{href:"#postgresql-procurement"},children:[{type:a,value:aX}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"PostgreSQL can be obtained in a number of different ways. The virtual machine is more than strong enough to host PostgreSQL alongside the server, within Docker, or connect through a managed instance. The database is what contains the most sensitive information and to ensure it isn't lost due to the volatility of the temporary virtual machine instance storage, using a managed PostgreSQL instance from Azure is preferred. This incurs a similar cost to the virtual machine itself but works best given the amount of credits OMC can utilize."}]},{type:a,value:c},{type:b,tag:ak,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"To get sarted, in the search box of the Azure portal type in "},{type:b,tag:f,props:{},children:[{type:a,value:"Postgres"}]},{type:a,value:" and select the option "},{type:b,tag:f,props:{},children:[{type:a,value:"Azure Database for PostgreSQL servers"}]},{type:a,value:B}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_pg_1.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once at the directory listing, click on "},{type:b,tag:f,props:{},children:[{type:a,value:"Add"}]},{type:a,value:" at the top and click create underneath "},{type:b,tag:f,props:{},children:[{type:a,value:"Single Server"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:bt},{type:b,tag:f,props:{},children:[{type:a,value:"Project details"}]},{type:a,value:" section, fill it out similarly to the virtual machine."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:bv},{type:b,tag:f,props:{},children:[{type:a,value:bw}]},{type:a,value:" start fill out the sections as appropriate:"}]},{type:a,value:c},{type:b,tag:ak,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Give the server a name, though it does not matter. I chose "},{type:b,tag:f,props:{},children:[{type:a,value:"omc-db"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Do not change "},{type:b,tag:f,props:{},children:[{type:a,value:"Data source"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:bx},{type:b,tag:f,props:{},children:[{type:a,value:"Location"}]},{type:a,value:by},{type:b,tag:f,props:{},children:[{type:a,value:bs}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:bv},{type:b,tag:f,props:{},children:[{type:a,value:"Version"}]},{type:a,value:" change it to "},{type:b,tag:f,props:{},children:[{type:a,value:"11"}]},{type:a,value:". This changes the PostgreSQL version to 11."}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_pg_2.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:al},{type:b,tag:f,props:{},children:[{type:a,value:"Configure server"}]},{type:a,value:" under "},{type:b,tag:f,props:{},children:[{type:a,value:"Compute + storage"}]},{type:a,value:" and the end of the "},{type:b,tag:f,props:{},children:[{type:a,value:bw}]},{type:a,value:" section. Here, click on the tab at the top to change the server type to "},{type:b,tag:f,props:{},children:[{type:a,value:"Basic"}]},{type:a,value:". Modify the settings to match, with a picture as a reference."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:R,props:{type:aA},children:[{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"If the image is too small to see, open it in a new tab to view it in full size."}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_pg_3.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:S,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:bz},{type:b,tag:f,props:{},children:[{type:a,value:"vCore"}]},{type:a,value:" setting until it says "},{type:b,tag:f,props:{},children:[{type:a,value:"1 vCore"}]},{type:a,value:". This is the number of CPU cores the database server will utilize. One is sufficient for a small application."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:bz},{type:b,tag:f,props:{},children:[{type:a,value:"Storage"}]},{type:a,value:" setting to the far left until it says "},{type:b,tag:f,props:{},children:[{type:a,value:"5 GB"}]},{type:a,value:". 5 Gigabytes of database storage is a lot for the app and will likely not be reached. This will scale if necessary due to the following setting, but setting this as low as possible cuts back on unnecessary costs."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:bx},{type:b,tag:f,props:{},children:[{type:a,value:"Storage Auto-growth"}]},{type:a,value:" setting remains on "},{type:b,tag:ay,props:{},children:[{type:a,value:bA}]},{type:a,value:". In the event the database is nearly reaching the 5 GB size limit, it will grow automatically."}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:"Leave the "},{type:b,tag:f,props:{},children:[{type:a,value:"Backup Retention Period"}]},{type:a,value:" set to "},{type:b,tag:ay,props:{},children:[{type:a,value:"7 Days"}]},{type:a,value:". Backups and retention policies can be modified by OMC if it is determined necessary."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:al},{type:b,tag:f,props:{},children:[{type:a,value:"OK"}]},{type:a,value:" at the bottom to return to the PostgreSQL creation page. Fill out the "},{type:b,tag:f,props:{},children:[{type:a,value:"Administrator account"}]},{type:a,value:" section as desired with the desired login credentials for the web administrator."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_pg_4.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:al},{type:b,tag:f,props:{},children:[{type:a,value:az}]},{type:a,value:" at the bottom and wait for provisioning."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_pg_5.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once provisioning is finished, return to the PostgreSQL directory listing and find the server instance. The database needs to be configured to accept certain authorized incoming connections."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"While still on the management page for the database, on the left hand side under "},{type:b,tag:f,props:{},children:[{type:a,value:bB}]},{type:a,value:", click on "},{type:b,tag:f,props:{},children:[{type:a,value:"Connection security"}]},{type:a,value:". From there, click on "},{type:b,tag:f,props:{},children:[{type:a,value:"Add current client IP address ( \u003Cyour ip\u003E )"}]},{type:a,value:". This will need to be done to each computer that wants remote access, or for testing purposes you can click on the "},{type:b,tag:f,props:{},children:[{type:a,value:"+ Add 0.0.0.0 - 255.255.255.255"}]},{type:a,value:" to allow all IP addresses to connect. Go ahead and also add the IP address of the virtual machine. Once done, click on "},{type:b,tag:f,props:{},children:[{type:a,value:"Save"}]},{type:a,value:" in the above toolbar."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_pg_6.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Using the "},{type:b,tag:f,props:{},children:[{type:a,value:"Admin username"}]},{type:a,value:", the "},{type:b,tag:f,props:{},children:[{type:a,value:"Server name"}]},{type:a,value:" and the password I set during the setup procedure, I am able to connect to the database using my preferred client, DataGrip. By default, PostgreSQL uses a port of 5432. Azure provides a guide on "},{type:b,tag:A,props:{href:"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fazure\u002Fpostgresql\u002Fquickstart-create-server-database-portal#configure-a-firewall-rule",rel:[X,Y,Z],target:_},children:[{type:a,value:"configuring a firewall rule"}]},{type:a,value:L},{type:b,tag:A,props:{href:"https:\u002F\u002Fdocs.microsoft.com\u002Fen-us\u002Fazure\u002Fpostgresql\u002Fquickstart-create-server-database-portal#connect-to-the-server-with-psql",rel:[X,Y,Z],target:_},children:[{type:a,value:"connecting to the server with psql"}]},{type:a,value:" CLI and making a new database manually if you do not have a database management tool."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fazure_pg_7.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"While connected, create a new database for the application to use. I created one named "},{type:b,tag:f,props:{},children:[{type:a,value:"omc"}]},{type:a,value:", though the application can be configured for any database name."}]},{type:a,value:c},{type:b,tag:M,props:{id:aY},children:[{type:b,tag:A,props:{href:"#sendgrid-account-creation"},children:[{type:a,value:aZ}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The SendGrid service provided by Azure will handle emailing. In the Azure portal search box type in SendGrid and click on "},{type:b,tag:f,props:{},children:[{type:a,value:"SendGrid Accounts"}]},{type:a,value:". In the directory, click on "},{type:b,tag:f,props:{},children:[{type:a,value:"New"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Setting up a new SendGrid account is largely administrative. The only configurable setting is the pricing tier which can be left on the lowest pricing tier. The contact information should be for the webmaster. Click on "},{type:b,tag:f,props:{},children:[{type:a,value:az}]},{type:a,value:" and await the deployment provisioning."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsendgrid_1.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once completed, visit the SendGrid account resource that was just created and click on the blue "},{type:b,tag:f,props:{},children:[{type:a,value:"Manage"}]},{type:a,value:" button. A welcome page will greet you, but do not click on the blue button, instead click on "},{type:b,tag:f,props:{},children:[{type:a,value:"Authenticate a domain instead"}]},{type:a,value:B}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsendgrid_2.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The next page will ask you where the DNS servers for the website are. Unless you have knowingly changed them they default to the provider in which the domain was purchased from. In my case that would be Google, so I selected "},{type:b,tag:f,props:{},children:[{type:a,value:"Google Cloud"}]},{type:a,value:" from the dropdown. For Bluehost, the domain provider of OMC, it will need to be input manually in the \"Other\" option at the bottom. Also select "},{type:b,tag:f,props:{},children:[{type:a,value:bA}]},{type:a,value:" for the second option."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsendgrid_3.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"On the next page it will simply ask for the domain you are sending from. This is the root domain of the website, e.g. "},{type:b,tag:f,props:{},children:[{type:a,value:"orlandomathcircle.org"}]},{type:a,value:" or "},{type:b,tag:f,props:{},children:[{type:a,value:bC}]},{type:a,value:" in my case. On the following page it will provide a list of "},{type:b,tag:f,props:{},children:[{type:a,value:"CNAME"}]},{type:a,value:" records to add to the domain in order to verify ownership and provide other security features. I will be doing this on Google Domains, though the process is usually ubiquitous."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsendgrid_4.png"},children:[]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsendgrid_5.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once they are added you can click on the checkbox at the bottom verifying that they were added and click on "},{type:b,tag:f,props:{},children:[{type:a,value:"Verify"}]},{type:a,value:" to check. If any are not working it will let you know which records are not found. It rarely takes more than a minute for DNS changes to propagate, though it rarely can take much longer. Once this is complete and SendGrid gives you a success message, click on "},{type:b,tag:f,props:{},children:[{type:a,value:bB}]},{type:a,value:" on the left toolbar and then "},{type:b,tag:f,props:{},children:[{type:a,value:"API Keys"}]},{type:a,value:" beneath it."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Create a new API Key, name it "},{type:b,tag:f,props:{},children:[{type:a,value:"App Credentials"}]},{type:a,value:" or similar, and make sure it has full access."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsendgrid_6.png"},children:[]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once created it will show you a key. Click to copy it and paste it into a file to save it temporarily until it's used later. The key will not be shown again, though it can be regenerated."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:R,props:{type:aA},children:[{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The application uses emailing templates to send emails in a structured way, however they were not completed by the first team. The second team will either need to create emailing templates or the app can send text-based emails as a fallback."}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:k,props:{className:[v,w]},children:[{type:a,value:c},{type:b,tag:aw,props:{id:a_},children:[{type:b,tag:A,props:{href:"#virtual-machine-setup"},children:[{type:a,value:a$}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once the virtual machine is operational, some software needs to be installed in order to run the application."}]},{type:a,value:c},{type:b,tag:M,props:{id:ba},children:[{type:b,tag:A,props:{href:"#1-creating-an-app-user"},children:[{type:a,value:bb}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"It is highly recommended to create a user on the Ubuntu machine that will own and run the code. The setup procedure and working on the server in the future is greatly simplified if a specific user representing the application owns and runs the code. Note that this user may have already been created for you by another."}]},{type:a,value:c},{type:b,tag:ak,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Create a new user on the server with name "},{type:b,tag:f,props:{},children:[{type:a,value:ad}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:"useradd"}]},{type:a,value:" -m app\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Switch to the app user."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:"su"}]},{type:a,value:" app\n"}]}]}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"From here on out, whenever a "},{type:b,tag:f,props:{},children:[{type:a,value:x}]},{type:a,value:" command is necessary you want to be on your regular Ubuntu account. Whenever you are working on the app in "},{type:b,tag:f,props:{},children:[{type:a,value:bD}]},{type:a,value:" or starting and restarting the app you should switch to the app account."}]},{type:a,value:c},{type:b,tag:M,props:{id:bc},children:[{type:b,tag:A,props:{href:"#2-installing-nodejs"},children:[{type:a,value:bd}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Node.js, the JavaScript server runtime, is installed using a small tool and a couple of commands. It is important you are on the user meant to run the application."}]},{type:a,value:c},{type:b,tag:S,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Visit the "},{type:b,tag:A,props:{href:"https:\u002F\u002Fgithub.com\u002Fnvm-sh\u002Fnvm#installing-and-updating",rel:[X,Y,Z],target:_},children:[{type:a,value:"NVM Installation Script"}]},{type:a,value:" page and copy the first link and run it in the terminal on the virtual machine. This installs the "},{type:b,tag:f,props:{},children:[{type:a,value:"Node Version Manager"}]},{type:a,value:", making it easy to install Node.js."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"When finished, reopen the terminal and connect to the virtual machine once again."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Run the following command"}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"nvm "},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aa}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:"14"}]},{type:a,value:c}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Double check that Node.js is now installed and reports the correct version."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"node -v\n"}]}]}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:M,props:{id:be},children:[{type:b,tag:A,props:{href:"#3-download-the-source-code"},children:[{type:a,value:bf}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Now the actual application needs to be downloaded and the dependencies installed. Where the code is downloaded is not important, so I will be putting it in the "},{type:b,tag:f,props:{},children:[{type:a,value:"\u002Fhome"}]},{type:a,value:" directory of the app user."}]},{type:a,value:c},{type:b,tag:S,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Clone the repository into the "},{type:b,tag:f,props:{},children:[{type:a,value:bD}]},{type:a,value:" folder."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:"git"}]},{type:a,value:" clone https:\u002F\u002Fgithub.com\u002Fduckies\u002Fomc-app.git app\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Run the sequence of commands to install the dependencies in the "},{type:b,tag:f,props:{},children:[{type:a,value:bE}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:bF}]},{type:a,value:bG}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,ae,af]},children:[{type:a,value:ag}]},{type:a,value:aB},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:T}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aa}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,ae,af]},children:[{type:a,value:ag}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:".."}]},{type:a,value:"\u002Ffrontend "},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:T}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aa}]},{type:a,value:c}]}]}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:M,props:{id:bg},children:[{type:b,tag:A,props:{href:"#4-configure-the-application"},children:[{type:a,value:bh}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Since the application is split into the "},{type:b,tag:am,props:{},children:[{type:a,value:bE}]},{type:a,value:L},{type:b,tag:am,props:{},children:[{type:a,value:bF}]},{type:a,value:" servers we need to input configuration data unique to the server so the application knows how to connect to the database and external services, what the domains are, and which operational behaviors to elicit."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"To do this, we will be creating "},{type:b,tag:f,props:{},children:[{type:a,value:aC}]},{type:a,value:" files which contain environment variables in the "},{type:b,tag:f,props:{},children:[{type:a,value:"~\u002Fapp\u002Ffrontend"}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:"~\u002Fapp\u002Fbackend"}]},{type:a,value:bG}]},{type:a,value:c},{type:b,tag:S,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Input the configuration for the frontend then save and close the file."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:$}]},{type:a,value:" ~\u002Fapp\u002Ffrontend\u002F.env\n"}]}]}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"STATIC_BASE"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:a,value:bH},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"AXIOS_BROWSER_BASE_URL"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:a,value:bH},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:bI}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:aD},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c}]}]}]},{type:a,value:c},{type:b,tag:R,props:{type:ac},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"It is expected that the Orlando Math Circle application will be available at "},{type:b,tag:f,props:{},children:[{type:a,value:"mobile.orlandomathcircle.org"}]},{type:a,value:" and the backend API at "},{type:b,tag:f,props:{},children:[{type:a,value:bq}]},{type:a,value:". However, for the tutorial I will be using a personal domain, "},{type:b,tag:f,props:{},children:[{type:a,value:bC}]},{type:a,value:" and the respective "},{type:b,tag:f,props:{},children:[{type:a,value:"app.johng.dev"}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:"api.johng.dev"}]},{type:a,value:". So replace the domain where appropriate."}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The backend has many more variables to configure."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:$}]},{type:a,value:" ~\u002Fapp\u002Fbackend.env\n"}]}]}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"SECRET"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:"random string with no spaces"},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"FRONTEND_URL"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:a,value:"https:\u002F\u002Fapp.johng.dev\n"},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:bJ}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:"your email"},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:bK}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:a,value:aE},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"SENDGRID_API_KEY"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:"provided by SendGrid"},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"SERVE_STATIC"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:a,value:aE},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"DATABASE_NAME"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:aF},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"DATABASE_HOST"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:"as given by Azure"},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"DATABASE_USER"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:aF},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"DATABASE_PASS"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:aF},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"DATABASE_SSL"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:a,value:aE},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:bI}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:aD},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"PAYPAL_SECRET_KEY"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:aD},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"TWITTER_KEY"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:bL},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,F,t]},children:[{type:a,value:"TWITTER_SECRET"}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:I}]},{type:a,value:bL},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:J}]},{type:a,value:c}]}]}]},{type:a,value:c},{type:b,tag:R,props:{type:ac},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The application will not accept real PayPal payments by default and requires "},{type:b,tag:f,props:{},children:[{type:a,value:"PAYPAL_SANDBOXED"}]},{type:a,value:" to be set to "},{type:b,tag:f,props:{},children:[{type:a,value:bM}]},{type:a,value:" in the backend "},{type:b,tag:f,props:{},children:[{type:a,value:aC}]},{type:a,value:" file. Ensure the app is tested thoroughly and working properly in a new deployment before turning this on."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"SendGrid will also not send emails unless "},{type:b,tag:f,props:{},children:[{type:a,value:bK}]},{type:a,value:by},{type:b,tag:f,props:{},children:[{type:a,value:bM}]},{type:a,value:". When set to true, emails are printed to the console."}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Run the following command while in the "},{type:b,tag:f,props:{},children:[{type:a,value:bN}]},{type:a,value:" subdirectory to attempt to connect to the database and create all of the necessary tables."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"npx mikro-orm schema:create -r --fk-checks\n"}]}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"If an error appears, it will describe the nature of the connection problem, otherwise the database and tables are all setup."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Now it should be possible to test that everything is working correctly by building and starting the backend. Run these commands in the "},{type:b,tag:f,props:{},children:[{type:a,value:bN}]},{type:a,value:" subdirectory and "},{type:b,tag:f,props:{},children:[{type:a,value:"Nest application successfully started"}]},{type:a,value:" should appear."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:bO},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:T}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:bP}]}]}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsetup_2.png"},children:[]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:M,props:{id:bi},children:[{type:b,tag:A,props:{href:"#5-installing-nginx"},children:[{type:a,value:bj}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The backend and frontend run by default on the local ports of 3000 and 8080 respectively. In order to expose those ports to the internet and map them to their respective domains NGINX acts as a proxy."}]},{type:a,value:c},{type:b,tag:S,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Run the following commands to update the Ubuntu repositories and then install Nginx."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aG}]},{type:a,value:" update "},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:T}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aG}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aa}]},{type:a,value:" nginx\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Test that Nginx is running by looking for "},{type:b,tag:f,props:{},children:[{type:a,value:"active (running)"}]},{type:a,value:" after the following command. You can also visit the IP address of the virtual machine and you should see a "},{type:b,tag:f,props:{},children:[{type:a,value:"Welcome to nginx!"}]},{type:a,value:" message."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:" systemctl status nginx\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Next we need to connect the virtual machine to the domains for the frontend and backend. In your domain registrar, add a new "},{type:b,tag:f,props:{},children:[{type:a,value:bQ}]},{type:a,value:" record for the "},{type:b,tag:f,props:{},children:[{type:a,value:ad}]},{type:a,value:L},{type:b,tag:f,props:{},children:[{type:a,value:"api"}]},{type:a,value:" subdomain both pointing to the IP of the virtual machine. Before continuing the DNS needs to propagate these changes, to ensure they are already propagated you may use the "},{type:b,tag:f,props:{},children:[{type:a,value:"dig \u003Csubdomain\u003E.\u003Cdomain\u003E"}]},{type:a,value:" command to ensure the "},{type:b,tag:f,props:{},children:[{type:a,value:bQ}]},{type:a,value:" record and IP address are listed correctly."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"This step is unique to your registrar and is not difficult to do find through Google if you need assistance."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once that is done, we need to tell Nginx about these two domains."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aH}]},{type:a,value:aI},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aH}]},{type:a,value:aJ}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Create a symlink from the available sites to the enabled sites. This is what tells Nginx which server blocks to use."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aK}]},{type:a,value:" -s \u002Fetc\u002Fnginx\u002Fsites-available\u002Fapi.johng.dev \u002Fetc\u002Fnginx\u002Fsites-enabled\u002F\n"},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aK}]},{type:a,value:" -s \u002Fetc\u002Fnginx\u002Fsites-available\u002Fapp.johng.dev \u002Fetc\u002Fnginx\u002Fsites-enabled\u002F\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Copy the following information into the server block. Be sure to set the correct "},{type:b,tag:f,props:{},children:[{type:a,value:an}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:$}]},{type:a,value:aI}]}]}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,ao]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:aL}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:U}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:V}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:U}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:ap}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:aq}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:V}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:an}]},{type:a,value:" api"},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:B}]},{type:a,value:bR},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:B}]},{type:a,value:bS},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:bT}]},{type:a,value:"            on"},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:bU}]},{type:a,value:"      text"},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:bV},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:bW},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:bX},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:bY},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:bZ}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:b_}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ah}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:b$}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:aM}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:ca},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:cb}]},{type:a,value:"                      off"},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:W}]},{type:a,value:" Host               "},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:aN}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:W}]},{type:a,value:ab},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:cc},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:"IP          "},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:cd}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:W}]},{type:a,value:ab},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:ar},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:"For    "},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:ce}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:W}]},{type:a,value:ab},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:ar},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:"Proto  "},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:cf}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:cg}]},{type:a,value:"                  "},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:as}]},{type:a,value:at},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ch}]},{type:a,value:"               "},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:as}]},{type:a,value:at},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ci}]},{type:a,value:"                          "},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:cj}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:ck}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:cl}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:cm}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:"3000"}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,"comment"]},children:[{type:a,value:"# Certbot renewal"}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ah}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:cn}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:co}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:B}]},{type:a,value:aO},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:aP},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:ai},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:aj},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:cp}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:cq},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:cr},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:ai},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:aj},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:c}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Then do the same for the other file."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:$}]},{type:a,value:aJ}]}]}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,ao]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:"map"}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:"$sent_http_content_type"}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:aM}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,au]},children:[{type:a,value:"\"text\u002Fhtml\""}]},{type:a,value:cs},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,au]},children:[{type:a,value:"\"text\u002Fhtml; charset=utf-8\""}]},{type:a,value:cs},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:"\n  default off"},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:"\n\n"},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:aL}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:U}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:V}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:U}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:ap}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:aq}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:V}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:an}]},{type:a,value:" app"},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:B}]},{type:a,value:bR},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:B}]},{type:a,value:bS},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:bT}]},{type:a,value:" on"},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:bU}]},{type:a,value:" text"},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:bV},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:bW},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:bX},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:bY},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:bZ}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:b_}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ah}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:b$}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:aM}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:ca},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:cb}]},{type:a,value:" off"},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:W}]},{type:a,value:" Host "},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:aN}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:W}]},{type:a,value:ab},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:cc},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:"IP "},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:cd}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:W}]},{type:a,value:ab},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:ar},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:bu},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:ce}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:W}]},{type:a,value:ab},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:ar},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:"Proto "},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:cf}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:cg}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:as}]},{type:a,value:at},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ch}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:as}]},{type:a,value:at},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ci}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:cj}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:ck}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:cl}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:cm}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:"8080"}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ah}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:cn}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:co}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:B}]},{type:a,value:aO},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:aP},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:ai},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:aj},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:cp}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:cq},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:cr},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:ai},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:aj},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:c}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Then we want to make sure that Nginx will accept the configuration. Run "},{type:b,tag:f,props:{},children:[{type:a,value:"sudo nginx -t"}]},{type:a,value:" and make sure there are no errors. Nginx is particular about the format of the server block files."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"If the configuration is valid we can reload Nginx."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:ct}]}]}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:M,props:{id:bk},children:[{type:b,tag:A,props:{href:"#6-configuring-letsencrypt"},children:[{type:a,value:bl}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Default HTTP traffic is not secure. If for no other reason, PayPal will not allow HTTP traffic to their service and modern browsers such as Chrome will show obtrusive warnings to users on websites that have not properly adopted HTTPS traffic. We can acheive this for free and easily using "},{type:b,tag:A,props:{href:"https:\u002F\u002Fletsencrypt.org\u002F",rel:[X,Y,Z],target:_},children:[{type:a,value:"LetsEncrypt"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:S,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Install the "},{type:b,tag:am,props:{},children:[{type:a,value:"Certbot"}]},{type:a,value:" tool used to generate LetsEncrypt certificates."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aG}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aa}]},{type:a,value:" certbot python3-certbot-nginx\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Run Certbot and supply both subdomains."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:" certbot --nginx -d api.johng.dev -d app.johng.dev\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"It will ask for some basic information and terms of service agreeances. However, if everything is successful it will complete the registraion for both domains. It will ask if you want to redirect HTTP traffic to HTTPS traffic, and we do, but we'll modify this ourselves so select option 1."}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsetup_3.png"},children:[]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"We now need to open both block files again and remove the ability to connect on the unsecured HTTP traffic."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:$}]},{type:a,value:aI},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:$}]},{type:a,value:aJ}]}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Remove the following lines from "},{type:b,tag:am,props:{},children:[{type:a,value:"both"}]},{type:a,value:" files."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,ao]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:U}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:V}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:U}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:ap}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:aq}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:V}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:c}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The default configuration file is no longer necessary and can be disabled by removing its symlink. It will still be available under "},{type:b,tag:f,props:{},children:[{type:a,value:"\u002Fetc\u002Fnginx\u002Fsites-available"}]},{type:a,value:" for reference."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:"rm"}]},{type:a,value:" \u002Fetc\u002Fnginx\u002Fsites-enabled\u002Fdefault\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The present configuration will not allow any non-SSL (HTTPS) traffic. The issue with this is if a user does not specify "},{type:b,tag:f,props:{},children:[{type:a,value:"https:\u002F\u002F"}]},{type:a,value:" in the url they will receive an error. Similarly, Certbot renews the certificate using regular HTTP. We can kill two birds with one stone using a catch-all Nginx server block that will allow Certbot challenges and redirecting all other traffic to HTTPS."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aH}]},{type:a,value:cu},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:$}]},{type:a,value:cu}]}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Paste and save the following. Note that "},{type:b,tag:f,props:{},children:[{type:a,value:"server_name _;"}]},{type:a,value:" is not an error but a catch-all."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,ao]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:aL}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:U}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:V}]},{type:a,value:cv},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:U}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:ap}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:aq}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:V}]},{type:a,value:cv},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:an}]},{type:a,value:" _"},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:ah}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:B}]},{type:a,value:aO},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:aP},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:ai},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:C}]},{type:a,value:aj},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:P}]},{type:a,value:E},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:"try_files"}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:"$uri"}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:D}]},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:"404"}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:G},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:N},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:"return"}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,y]},children:[{type:a,value:"301"}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,n]},children:[{type:a,value:"https"}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:H}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:u}]},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:aN}]},{type:b,tag:d,props:{className:[e,t]},children:[{type:a,value:"$request_uri"}]},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:o}]},{type:a,value:c},{type:b,tag:d,props:{className:[e,i]},children:[{type:a,value:Q}]},{type:a,value:c}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Create a symlink to enable the new block."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aK}]},{type:a,value:" -s \u002Fetc\u002Fnginx\u002Fsites-available\u002Fcertbot \u002Fetc\u002Fnginx\u002Fsites-enabled\u002F\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Ensure that the configuration is valid."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:" nginx -t\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Restart Nginx"}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:ct}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"LetsEncrypt certificates only last 90 days or so, so we want to make sure the Certbot installed the services to auto-renew the certificate for us. Verify that the following service reports "},{type:b,tag:f,props:{},children:[{type:a,value:"active (waiting)"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:" systemctl status certbot.timer\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Also make sure the following dry-run of a Certbot renewal works correctly. This ensures our Nginx sites are configured properly."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:x}]},{type:a,value:" certbot renew --dry-run\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"We can quickly test that everything is setup by starting the backend server and going to "},{type:b,tag:f,props:{},children:[{type:a,value:"https:\u002F\u002Fapi.johng.dev\u002F"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,ae,af]},children:[{type:a,value:ag}]},{type:a,value:aB},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:T}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:bO},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:T}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:bP}]}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The following text should be displayed when visiting the API subdomain."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,cw]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"{\"statusCode\":404,\"message\":\"Cannot GET \u002F\",\"error\":\"Not Found\"}\n"}]}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"This is a JSON API response, meaning the backend is successfully operational. Also ensure that the little lock icon by the address bar indicates a secure SSL connection."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Open a second terminal while the backend is still running and test that "},{type:b,tag:f,props:{},children:[{type:a,value:"https:\u002F\u002Fapp.johng.dev\u002F"}]},{type:a,value:" is working by starting the frontend."}]},{type:a,value:c},{type:b,tag:R,props:{type:ac},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"The frontend may take a considerable amount of time to build. So while it may appear to hang at times, it is still running."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,cw]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"cd ~\u002Fapp\u002Ffrontend && npm run build && npm run start\n"}]}]}]},{type:a,value:c},{type:b,tag:z,props:{src:"\u002Fimages\u002Fproduction\u002Fsetup_4.png"},children:[]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Now visit "},{type:b,tag:f,props:{},children:[{type:a,value:"https:\u002F\u002Fapp.johng.dev"}]},{type:a,value:" ("},{type:b,tag:f,props:{},children:[{type:a,value:"https:\u002F\u002Fmobile.orlandomathcircle.org"}]},{type:a,value:") in the browser and it should show the app landing page. Also verify that the browser indicates the connection is secure."}]},{type:a,value:c},{type:b,tag:M,props:{id:bm},children:[{type:b,tag:A,props:{href:"#configuring-pm2"},children:[{type:a,value:bn}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Is is not convenient to manually start the frontend and backend. The virtual machine can manage starting and restarting both on its own through the use of the "},{type:b,tag:A,props:{href:"https:\u002F\u002Fpm2.keymetrics.io\u002F",rel:[X,Y,Z],target:_},children:[{type:a,value:"PM2 Node.js library"}]},{type:a,value:B}]},{type:a,value:c},{type:b,tag:S,props:{},children:[{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"While still on the "},{type:b,tag:f,props:{},children:[{type:a,value:ad}]},{type:a,value:" user, run the following command to install pm2 globally."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:j},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:aa}]},{type:a,value:" -g pm2\n"}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Now we can instruct PM2 to manage starting the frontend and backend."}]},{type:a,value:c},{type:b,tag:R,props:{type:ac},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Stop the the frontend and backend if they are currently running before executing the following commands."}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,ae,af]},children:[{type:a,value:ag}]},{type:a,value:aB},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:T}]},{type:a,value:cx},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:cy},{type:b,tag:d,props:{className:[e,au]},children:[{type:a,value:"\"backend\""}]},{type:a,value:cz},{type:b,tag:d,props:{className:[e,ae,af]},children:[{type:a,value:ag}]},{type:a,value:" ~\u002Fapp\u002Ffrontend "},{type:b,tag:d,props:{className:[e,g]},children:[{type:a,value:T}]},{type:a,value:cx},{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:O}]},{type:a,value:cy},{type:b,tag:d,props:{className:[e,au]},children:[{type:a,value:"\"frontend\""}]},{type:a,value:cz}]}]}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:m,props:{},children:[{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"PM2 will now ensure that the frontend and backend stay running and restart if they close for whatever reason. Logs for each can be viewed with "},{type:b,tag:f,props:{},children:[{type:a,value:"pm2 logs \u003Cname|id|all\u003E"}]},{type:a,value:". However, PM2 will need to configure a startup script to handle the case when the virtual machine itself restarts or crashes and reboots."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:a,value:"pm2 startup\n"}]}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"It will print out the command you need to copy and paste to enable the startup script. The command is a "},{type:b,tag:f,props:{},children:[{type:a,value:x}]},{type:a,value:" command and cannot be run on the "},{type:b,tag:f,props:{},children:[{type:a,value:ad}]},{type:a,value:" user so switch to your regular account. It is visible in the command that pm2 will be started as the "},{type:b,tag:f,props:{},children:[{type:a,value:ad}]},{type:a,value:" user when the system restarts."}]},{type:a,value:c}]},{type:a,value:c}]},{type:a,value:c},{type:b,tag:M,props:{id:bo},children:[{type:b,tag:A,props:{href:"#final-steps"},children:[{type:a,value:bp}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"There are a couple remaining steps to setting up the application."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"By default the backend is expecting to host static files itself. Ideally this may be best handled by Nginx for caching reasons if the new team wishes to undertake this change. Uploads are not stored within the directory containing the application code as it's meant to be a volatile directory where changes to the code can mess with directories. Thus, by default the backend will create an "},{type:b,tag:f,props:{},children:[{type:a,value:"uploads"}]},{type:a,value:" directory at the same level as the folder where the code is stored and we need to copy the default avatar images into there."}]},{type:a,value:c},{type:b,tag:k,props:{className:[p]},children:[{type:b,tag:q,props:{className:[r,s]},children:[{type:b,tag:f,props:{},children:[{type:b,tag:d,props:{className:[e,l]},children:[{type:a,value:"cp"}]},{type:a,value:" -R ~\u002Fapp\u002Fimages ~\u002Fuploads\n"}]}]}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Lastly, in order to create an administrator account either a regular account can be made and the database modified to change a users roles to "},{type:b,tag:f,props:{},children:[{type:a,value:"{admin}"}]},{type:a,value:", or the "},{type:b,tag:f,props:{},children:[{type:a,value:bJ}]},{type:a,value:" setting in the backend "},{type:b,tag:f,props:{},children:[{type:a,value:aC}]},{type:a,value:" file is set so that a user registering with that exact email will be promoted to admin during registration."}]},{type:a,value:c},{type:b,tag:h,props:{},children:[{type:a,value:"Once an admin account exists, other admins can be promoted from the admin panel."}]},{type:a,value:c}]}]},dir:"\u002Finstallation",path:"\u002Finstallation\u002F3.production",extension:".md",createdAt:"2021-02-26T11:22:20.775Z",updatedAt:"2021-02-26T11:22:20.779Z",position:"999900030000",to:"\u002Finstallation\u002Fproduction",language:"en",draft:false},prev:{slug:"development",title:"Development",to:"\u002Finstallation\u002Fdevelopment"},next:{slug:"services",title:"Services Setup",to:"\u002Finstallation\u002Fservices"}}],fetch:[],mutations:void 0}}("text","element","\n","span","token","code","operator","p","punctuation"," ","div","function","li","keyword",";","nuxt-content-highlight","pre","line-numbers","language-bash","variable","\u002F","prose","dark:prose-dark","sudo","number","img","a",".","-","=","\n    ","assign-left","\n  ",":","\u003C","\u003E",3," and ","h3","\n\n  ","npm","{","}","alert","ol","&&","listen","80","proxy_set_header","nofollow","noopener","noreferrer","_blank","nano","install"," X","warning","app","builtin","class-name","cd","location","acme","challenge","ul","Click on ","em","server_name","language-nginx","[","]","Forwarded","1","m","string",2,"h2","Azure Instance Details","strong","Review + create","info"," ~\u002Fapp\u002Fbackend ",".env","provided by PayPal","true\n","as configured previously","apt","touch"," \u002Fetc\u002Fnginx\u002Fsites-available\u002Fapi.johng.dev\n"," \u002Fetc\u002Fnginx\u002Fsites-available\u002Fapp.johng.dev\n","ln","server","$expires","$host","well","known","requirements","Requirements","azure","Azure","virtual-machine-procurement","Virtual Machine Procurement","postgresql-procurement","PostgreSQL Procurement","sendgrid-account-creation","SendGrid Account Creation","virtual-machine-setup","Virtual Machine Setup","1-creating-an-app-user","1. Creating an App User","2-installing-nodejs","2. Installing Node.js","3-download-the-source-code","3. Download the Source Code","4-configure-the-application","4. Configure the Application","5-installing-nginx","5. Installing Nginx","6-configuring-letsencrypt","6. Configuring LetsEncrypt","configuring-pm2","Configuring PM2","final-steps","Final Steps","api.orlandomathcircle.org","Client Key","(US) East US","For the ","For ","Under ","Server details","Ensure the "," is set to ","Slide the ","Yes","Settings","johng.dev","~\u002Fapp","frontend","backend"," folders.","https:\u002F\u002Fapi.johng.dev\n","PAYPAL_CLIENT_ID","ADMIN_EMAIL","SENDGRID_IN_DEV","provided by Twitter","false","\u002Fbackend"," run build "," run start\n","A","johng","dev","gzip","gzip_types","plain application","xml text","css application","javascript","gzip_min_length","1000","expires","\n\n    ","proxy_redirect","Real","$remote_addr","$proxy_add_x_forwarded_for","$scheme","proxy_read_timeout","proxy_connect_timeout","proxy_pass","http","127.0",".0",".1","^","~","alias","var","www"," epoch"," systemctl reload nginx\n"," \u002Fetc\u002Fnginx\u002Fsites-available\u002Fcertbot\n"," default_server","language-text"," pm2 start "," --name "," -- start\n")));